#!/bin/bash

readmeSources="./README.source.md ./apps/kmail/README.source.md"

mkdir -p sheets previews

colouredweb --build=sheets,previews

for readmeSource in $readmeSources; do
    readmeFile="$(echo "$readmeSource" | cut -d\. -f1,2).md"
    
    echo "Building ${readmeFile}".
    {
        echo "<!-- This file has been generated from $0. If you want to edit it, edit \"$readmeSource\" and then run $0 again. -->"
        cat "$readmeSource"
        echo
        cat "preview.md"
    } > "${readmeFile}"
done

for app in apps/*; do
    echo "Copying sheets to $app".
    rm -Rf "$app/sheets" "$app/previews"
    cp -R sheets previews "$app"
done
